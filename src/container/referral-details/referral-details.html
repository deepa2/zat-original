<!--
  Generated template for the WowPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>Referral Details</ion-title>
  </ion-navbar>
</ion-header>


<ion-content class="form-wrapper">
  <form class="pad-16" #createReferral="ngForm" *ngIf="mainData" novalidate>
       <div class="basic-info" [style.visibility]="!showAdditionalInfo ? 'visible' : 'hidden'" [style.height]="!showAdditionalInfo ? 'auto' : '0'">
      <div class="progress step1">
        <div class="one prog-item">1</div>
        <div class="line"></div>
        <div class="two prog-item">2</div>
      </div>
      <div class="info-wrapper">
        <div class="associate-details">
          <ion-label class="form-label asso-name" >My Contact Number <img class="asterisck"
            src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-label class="form-label">{{mainData.associateMobileNumber}}
      </ion-label>
        </div>
      <div class="ref-title"><img class="about-user" src="assets/imgs/user.svg" />About Referral</div>
      <ion-item>
        <ion-label floating class="form-label" >Title <img class="asterisck"
            src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-select name="title" [(ngModel)]="mainData.title" required>
          <ion-option *ngFor="let title of mainData.titleLov" [value]="title?.key">{{title.value}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-label floating class="form-label">First Name <img class="asterisck" src="assets/imgs/asterisk.svg" />
        </ion-label>

        <ion-input type='text' class="capitalise" [(ngModel)]="mainData.firstName" (change)="changeFlag()" name="firstName" pattern="^[a-zA-Z, ]+$" minlength="2" #firstName="ngModel" required>
        </ion-input>
       
      </ion-item>
      <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)"  class="alert alert-danger">
        <div *ngIf="firstName.errors.minlength">
          First name should be atleast 2 characters long.
        </div>
       
        <div *ngIf="firstName.errors.required || firstName.invalid && !firstName.errors.minlength">
          Only alphabets are allowed.
        </div>
      </div>
      <ion-item>
        <ion-label floating class="form-label">Middle Name
        </ion-label>

        <ion-input type='text' class="capitalise" [(ngModel)]="mainData.middleName" (change)="changeFlag()" #mName="ngModel"  pattern="^[a-zA-Z, ]+$" name="middleName" value=" ">
        </ion-input>
      </ion-item>
      <div *ngIf="mName.invalid && (mName.dirty || mName.touched)"  class="alert alert-danger">
      
        <div *ngIf="mName.errors.required || mName.invalid && !mName.errors.minlength">
          Only alphabets are allowed.
        </div>
      </div>
      <ion-item>
        <ion-label floating class="form-label">Last Name <img class="asterisck" src="assets/imgs/asterisk.svg" />
        </ion-label>

        <ion-input type='text' class="capitalise" [(ngModel)]="mainData.lastName" (change)="changeFlag()" name="lastName" pattern="^[a-zA-Z, ]+$" #lastName="ngModel" required>
        </ion-input>
      </ion-item>
      <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)"  class="alert alert-danger">
        <div *ngIf="lastName.errors.minlength">
          Last name should be atleast 2 characters long.
        </div>
       
        <div *ngIf="lastName.errors.required || lastName.invalid && !lastName.errors.minlength">
          Only alphabets are allowed.
        </div>
      </div>
      <ion-item>
        <ion-label floating class="form-label">Email Address <img class="asterisck" src="assets/imgs/asterisk.svg" />
        </ion-label>

        <ion-input type="email" class="email lowercase" (change)="changeFlag()" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" [(ngModel)]="mainData.emailAddress" name="emailAddress" #email="ngModel" placeholder="xyz@abc.com"  required>
        </ion-input>
      </ion-item>
      <div *ngIf="email.invalid && (email.dirty || email.touched)"  class="alert alert-danger">
        <div *ngIf="email.errors.required">
          Please enter valid email.
        </div>
      </div>
      <div class="two-form-item">
        <ion-item>
          <ion-label floating class="form-label" class="noColor">Gender <img class="asterisck"
              src="assets/imgs/asterisk.svg" />
          </ion-label>
          <ion-select name="gender" [(ngModel)]="mainData.gender" item-content (onChange)="getgender($event)" required>
            <ion-option *ngFor="let gender of mainData?.genderLov" [value]="gender.key">{{gender.value}}</ion-option>
          </ion-select>
        </ion-item>
        <ion-item>
          <ion-label floating class="form-label" class="noColor">DOB <img class="asterisck"
              src="assets/imgs/asterisk.svg" />
          </ion-label>
          <ion-datetime [(ngModel)]="mainData.dateOfBirth" [max]="maxDate"  name="dateOfBirth" displayFormat="MMM DD, YYYY" required></ion-datetime>
        </ion-item>
      </div>
      <div class="two-form-item">
        <ion-item>
          <ion-label floating class="form-label">Contact Number <img class="asterisck" src="assets/imgs/asterisk.svg" />
          </ion-label>

          <ion-input type='number' #mobile="ngModel" (change)="changeFlag()" [(ngModel)]="mainData.cellularNumber" name="cellularNumber" required></ion-input>
        </ion-item>
        <div *ngIf="mobile.invalid && (mobile.dirty || mobile.touched)"  class="alert alert-danger">
          <div *ngIf="mobile.errors.required">
            Please enter mobile.
          </div>
        </div>
        <ion-item>
          <ion-label floating class="form-label">Alternate Number
          </ion-label>

          <ion-input type='number' [(ngModel)]="mainData.homePhone" name="homePhone">
          </ion-input>
        </ion-item>
        <!-- <ion-item>
          <ion-label floating class="form-label">Work Number
          </ion-label>

          <ion-input type='number' [(ngModel)]="mainData.workNumber" name="workNumber" required>
          </ion-input>
        </ion-item> -->
      </div>

      <ion-item>
        <ion-label floating class="form-label">PAN <img class="asterisck" src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-input type='text' class="pan" #PAN="ngModel" (change)="changeFlag()" pattern="[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}" [(ngModel)]="mainData.panCard" name="panCard" minlength="10" maxlength="10" placeholder="XXXXX0000X" required>
        </ion-input>
      </ion-item>
      <div *ngIf="PAN.invalid && (PAN.dirty || PAN.touched)"  class="alert alert-danger">
        <div *ngIf="PAN.errors.required || PAN.invalid">
          Please enter valid PAN.
        </div>
      </div>
      <ion-item>
        <ion-label floating class="form-label capitalise">City <img class="asterisck" src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-input type='text' class="capitalise" #city="ngModel" (change)="changeFlag()" [(ngModel)]="mainData.city" name="city" required>
        </ion-input>
      </ion-item>
      <div *ngIf="city.invalid && (city.dirty || city.touched)"  class="alert alert-danger">
        <div *ngIf="city.errors.required">
          Please enter city.
        </div>
      </div>
      <div class="textarea-wrapp">
        <ion-label class="form-label text-label">About Candidate 
          <img class="asterisck" src="assets/imgs/asterisk.svg" />
          <span class="note">(Min 20 char)</span>
        </ion-label>
        <ion-textarea class="about-cand" (change)="changeFlag()" [(ngModel)]="mainData.aboutCandidate" rows="4" cols="20" minlength="20" #aboutBody="ngModel" name="aboutCandidate" required></ion-textarea>
        <div *ngIf="aboutBody.invalid && (aboutBody.dirty || aboutBody.touched)" class="alert alert-danger">

          <div *ngIf="aboutBody.errors.required">
            About candidate is required.
          </div>
          <div *ngIf="aboutBody.errors.minlength">
            About candidate must be at least 20 characters long.
          </div>

      </div>
      </div>
    </div>
      <!-- <ion-input type='hidden' [(ngModel)]="mainData.stepCount" name="stepCount" value="1"> </ion-input> -->
      <ion-input type='hidden' [(ngModel)]="mainData.candidateProfileId" name="candidateProfileId"> </ion-input>
      <ion-input type='hidden' [(ngModel)]="mainData.fullName" name="fullName"> </ion-input>
      <ion-input type='hidden' [(ngModel)]="mainData.srfNumber" name="srfNumber"> </ion-input>
     
        <!-- <ion-footer *ngIf="!showAdditionalInfo && showfooter" class="fotterBtn 2"> -->
          <div class="refer-friend-btn" *ngIf="!showAdditionalInfo && showfooter">
            <button [disabled]="diableSave" (click)="saveReferral('save')"  class="save" type="submit">Save</button>
            <button [disabled]="!shownext && !step1Validate" (click)="saveReferral('next')" type="submit">Next</button>
           
          </div>
        <!-- </ion-footer> -->
    </div>
  
  <div class="additional-info" [style.visibility]="showAdditionalInfo ? 'visible' : 'hidden'" [style.height]="showAdditionalInfo ? 'auto' : '0'">
      <div class="progress step2">
        <div class="one prog-item">1</div>
        <div class="line"></div>
        <div class="one prog-item">2</div>
      </div>
      <div class="info-wrapper">
      <div class="ref-title"><img class="about-user" src="assets/imgs/aditional-info.svg" />Additional Information</div>
      <ion-item>
        <ion-label floating class="form-label" class="noColor">Candidate's Total Experience <img class="asterisck"
            src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-select name="experience" [(ngModel)]="mainData.experience" item-content>
          <ion-option *ngFor="let experience of mainData?.experienceLov" [value]="experience.key">{{experience.value}}
          </ion-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-label floating class="form-label" class="noColor">Notice Period <img class="asterisck"
            src="assets/imgs/asterisk.svg" />
        </ion-label>
        <ion-select name="noticePeriod" [(ngModel)]="mainData.noticePeriod" item-content>
          <ion-option *ngFor="let noticePeriod of mainData?.noticePeriodLov" [value]="noticePeriod.key">
            {{noticePeriod.value}}</ion-option>
        </ion-select>
      </ion-item>
      <div class="comp-title">
        <div>Competencies</div>
        <div class="add-new" (click)="openCompetency(item,-1, mainData.proLangLov,mainData.proficiencyLov,mainData.experienceLov,mainData.lastUsedLov,mainData.interestLov)">Add New</div>
      
      </div>
      <div class="competency-wrapper">
        <div class="comp-item" *ngFor="let item of mainData.competencies let i = index">
          <div class="comp-info" (click)="openCompetency(item,i, mainData.proLangLov,mainData.proficiencyLov,mainData.competencyExperienceLov,mainData.lastUsedLov,mainData.interestLov)">
            <div class="expert-con">
              <img class="expert-icon" src="assets/imgs/expert-icon.svg" />
              Expert
            </div>
            <div class="skill-desc">{{item.skillDesc}}</div>
            
          </div>
         <div class="comp-exp" (click)="openCompetency(item,i, mainData.proLangLov,mainData.proficiencyLov,mainData.competencyExperienceLov,mainData.lastUsedLov,mainData.interestLov)">Experience : {{item.expDesc}}</div>
          <img class="delete-skills" (click)="$event.stopPropagation();presentskillsConfirm(item.skillId,i)"  src="assets/imgs/Deleteblack.svg" />
        </div>
      </div>
      <div class="attachment">
        <ion-label class="form-label" class="noColor" tooltip="I'm a tooltip below a button">Resume 
          <img class="asterisck" src="assets/imgs/asterisk.svg" />
          <div class="note">(Pdf ,Doc , Docx or Odt upto 3mb only )</div>
          
            
        </ion-label>
        <div class="file-upload">
          <span class="upload" (click)="uploadDoc()"><span> <img class="upload-res" src="assets/imgs/upload-resume.svg" /> Upload</span></span>
          <!-- <span class="uploadIcon"><img class="down-img" src="assets/imgs/Upload.svg"></span> -->
        </div>
      </div>
      <ng-container *ngIf="showoldDoc">
        <div class="attachment-list" *ngFor="let item of mainData?.candidateDocuments">
          {{item.documentName}}
          <div class="preview" (click)="openPdfFile(item.documentUrl) " >Preview</div>
          <img class="delete-doc" (click)="presentsResumeConfirm()"  src="assets/imgs/delete-resume.svg" />
          
        </div>
      </ng-container>
    
    </div>
    <!-- <ion-footer *ngIf="showAdditionalInfo && showfooter" class="fotterBtn 2"> -->
      <div class="refer-friend-btn" *ngIf="showAdditionalInfo && showfooter">
        <div class="nextBtn" (click)="goToBack()">Back</div>
        <!-- <div class="nextBtn" (click)="goToReferralInfo()">next</div> -->
        <button *ngIf="fromsaved" (click)="saveReferral('save')" type="submit">Save</button>
        <button *ngIf="!fromsaved" (click)="saveReferral('next2')" type="submit">Next</button>
      </div>
    <!-- </ion-footer> -->
    </div>
    
  </form>
</ion-content>