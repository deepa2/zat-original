<!--
  Generated template for the ZendeavorTeamListPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title *ngIf="!isSearchbarOpened">Team List</ion-title>
    <ion-buttons end *ngIf="this.showHeaderButton && selectedItem !='Reviewer' && !teamListResData?.isExpired">
      <button ion-button class="headerBtn" (click)="sendReminder()">Send Reminder</button>
      <button ion-button icon-only (click)="presentOptions($event)">
        <ion-icon name="more"></ion-icon>
      </button>
    </ion-buttons>
    <ion-buttons end (click)="openTeamMeanModal()">
      <div class="teamMean current-mean-color" *ngIf="(getTeamListData?.isModeration && statusModel=='moderation')||selectedItem =='Reviewer'">
        <div class="teamMean-icon-div">
          <img class="user-profile" [src]="getTeamListData?.currentMean?.icon" onerror="this.src='assets/menu_icons/1-UpManager.svg'">
        </div>
        <div class="padding-rt-left5 currentMeanTitle">{{getTeamListData?.currentMean?.key}}</div>
        <div>{{getTeamListData?.currentMean?.value}}</div>
        <ion-icon class="padding-rt-left5" name="ios-arrow-down"></ion-icon>
      </div>

    </ion-buttons>
    <!-- <button (click)="openSearch()">search associate</button> -->
  </ion-navbar>

</ion-header>


<ion-content>
  <!-- ion segment -->
  <ion-segment [(ngModel)]="statusModel" (ionChange)="segmentChanged($event,statusModel)" *ngIf="selectedItem !='Reviewer'">
    <ion-segment-button value="inProgress" class="custom-segment"><span>In Progress</span> <span>{{pendingListCount}}</span></ion-segment-button>
    <ion-segment-button value="submitted" class="custom-segment"><span>Submitted</span> <span>{{submittedListCount}}</span> </ion-segment-button>
    <ion-segment-button value="approved" class="custom-segment"> <span>Completed</span> <span>{{approvedListCount}}</span> </ion-segment-button>
    <ion-segment-button value="moderation" class="custom-segment" [hidden]="!getTeamListData?.isModeration"><span>Moderation</span> <span> {{moderationList?.length}}</span>
     </ion-segment-button>

  </ion-segment>

  <div [ngSwitch]="statusModel">

    <!-- Pending List Code -->

    <div *ngSwitchCase="'inProgress'" class="parentDiv" [hidden]="selectedItem =='Reviewer'">
      <ion-list *ngFor="let pendingItem of pendingList; let i=index;" (click)="selectCard(pendingItem,i)">
        <ion-card class="infoClass">
          <div class="divFirst">
            <ion-item class="padding0 padding-left7">
              <ion-avatar item-start>
                <img class="imgCls" [src]="pendingItem?.employeeProfilePic">
                <img *ngIf="inSelectionMode && pendingItem?.isSelected" class="selectedImg" src="assets/imgs/ZenDeavour/selected.svg">
              </ion-avatar>
              <h3 class="empName">{{pendingItem?.employeeName}}</h3>
              <p>{{pendingItem?.employeeId}}</p>
            </ion-item>
          </div>

          <div class="divSecond">
            <div class="subDiv">
              <span class="status font8em">Reminder</span>
              <span class="statusColor font8em">{{pendingItem?.reminderCount}} Sent</span>
            </div>
            <div *ngIf="!teamListResData?.isExpired">
              <span class="iconSize pd5" (click)="sendReminderPopover($event,pendingItem?.employeeId)">
                <ion-icon name="more"></ion-icon>
              </span>
            </div>
          </div>
        </ion-card>



      </ion-list>
      <div class="nodata " *ngIf="pendingListCount==0">No Data Available</div>
    </div>
    <!-- list of data -->
    <div *ngSwitchCase="'submitted'" class="parentDiv">

      <ion-list *ngFor="let submittedItem of submittedList" (click)="openKRAPage(submittedItem)">
        <ion-card class="infoClass">
          <div class="divFirst">
            <ion-item class="padding0 padding-left7">
              <ion-avatar item-start>
                <img class="imgCls" [src]="submittedItem?.employeeProfilePic">
                <!-- <img *ngIf="inSelectionMode && submittedItem?.isSelected" class="selectedImg"
                  src="assets/imgs/ZenDeavour/selected.svg"> -->
              </ion-avatar>

              <h3 class="empName">{{submittedItem?.employeeName}}</h3>
              <p>{{submittedItem?.employeeId}}</p>
            </ion-item>
          </div>

          <div class="divSecond">
            <div class="subDiv">
              <span class="status font8em">Date</span>
              <span class="statusColor font8em">{{submittedItem?.submissionDate | date : 'd MMM yyyy'}}</span>
            </div>
            <div (click)="openPopover($event,submittedItem?.employeeId)" class="padding7px" *ngIf="!teamListResData?.isExpired">
              <span class="iconSize">
                <ion-icon name="more"></ion-icon>
              </span>
            </div>
          </div>
        </ion-card>

      </ion-list>

      <div class="nodata" *ngIf="submittedListCount==0">No Data Available</div>
    </div>


    <!-- list of data -->
    <div *ngSwitchCase="'approved'" class="parentDiv">

      <ion-list *ngFor="let approvedItem of approvedList" (click)="openPreview(approvedItem)">
        <ion-card class="infoClass">
          <div class="divFirst">
            <ion-item class="padding0 padding-left7">
              <ion-avatar item-start>
                <img class="imgCls" [src]="approvedItem?.employeeProfilePic">
                <img class="selectedImg" *ngIf="approvedItem?.appraisalStatus =='COMPLETED'" src="assets/imgs/ZenDeavour/ZenDeavour_approved.svg">
                <img class="selectedImg" *ngIf="approvedItem?.appraisalStatus=='CLOSED' || approvedItem?.appraisalStatus=='PENDING FOR CLOSE'"
                  src="assets/imgs/ZenDeavour/ZenDeavour_disapproved.svg">
              </ion-avatar>
              <h3 class="empName">{{approvedItem?.employeeName}}</h3>
              <p>{{approvedItem?.employeeId}}</p>
            </ion-item>
          </div>

          <div class="divSecond">
            <div class="subDiv">
              <span class="status font8em">Date</span>
              <span class="statusColor font8em">{{approvedItem?.submissionDate | date : 'd MMM yyyy'}}</span>

            </div>

            <!-- <div (click)="openPopover($event,approvedItem?.employeeId)">
              <span class="iconSize" >
                <ion-icon name="more"></ion-icon>
              </span>
            </div> -->
          </div>
        </ion-card>
      </ion-list>

      <div class="nodata" *ngIf="approvedListCount==0">No Data Available</div>

    </div>

    <!-- Moderation List -->
    <div *ngSwitchCase="'moderation'" class="parentDiv">

      <ion-list *ngFor="let moderationItem of moderationList" (click)="redirectModerator(moderationItem)">
        <ion-card class="infoClass">
          <div class="divFirst">
            <ion-item class="padding0 padding-left7">
              <ion-avatar item-start>
                <img class="imgCls" [src]="moderationItem?.employeeProfilePic">
                <img class="selectedImg" *ngIf="moderationItem?.appraisalStatus =='COMPLETED'" src="assets/imgs/ZenDeavour/ZenDeavour_approved.svg">
                <img class="selectedImg" *ngIf="moderationItem?.appraisalStatus=='CLOSED' || moderationItem?.appraisalStatus=='PENDING FOR CLOSE'"
                  src="assets/imgs/ZenDeavour/ZenDeavour_disapproved.svg">
              </ion-avatar>
              <h3 class="empName">{{moderationItem?.employeeName}}</h3>
              <p>{{moderationItem?.employeeId}}</p>
            </ion-item>
          </div>

          <div class="divSecond">
            <div class="subDiv">
              <span class="status font8em">{{moderationItem?.appraiserScore?.key}}</span>
              <span class="statusColor font8em">{{moderationItem?.appraiserScore?.value}}</span>

            </div>
            <!-- <div (click)="openPopover($event,submittedItem?.employeeId)" class="pd5">
              <span class="iconSize">
                <ion-icon name="more"></ion-icon>
              </span>
            </div> -->
          </div>
        </ion-card>
      </ion-list>

      <div class="justify-cont-center padding1em" *ngIf="moderationList?.length==0">No Data Available</div>

    </div>




  </div>
  <!-- Reviewer List -->

  <div *ngIf="selectedItem =='Reviewer'">
    <div class="associate-card" *ngFor="let reviewerItem of reviewersList">
      <div class="associate-details-rw">
        <div class="associate-profile-pic"><img [src]="reviewerItem?.employeeProfilePic" onerror="this.src='assets/imgs/dummy-profile.png'"></div>
        <div class="associate-info">
          <div class="associate-name">{{reviewerItem?.employeeName}}</div>
          <div class="associate-id margin-top5">{{reviewerItem?.employeeId}}</div>
        </div>
      </div>
      <div>
        <div class="teamMean-container margin-topBottom5" *ngFor="let teamMean of reviewerItem?.teamMeanList">
          <div class="">
            <div class="teamMean width-85px" (click)="openReviewersTeamList(teamMean.key,teamMean,reviewerItem?.employeeId)">{{teamMean?.key}}</div>

            <div style="display:flex; flex-direction: row;">
              <div class="statusColor" (click)="openReviewersTeamList(teamMean.key,teamMean,reviewerItem?.employeeId)">{{teamMean?.value}}</div>
              <div *ngIf="teamMean?.key=='Team Mean'">
                <ion-icon [tooltip]="reviewerItem?.appraiserMeanToolTip" positionV="bottom" hideOthers="true" [event]="tooltipEvent"
                  clear color="dark" item-right>
                  <img class="info-icon" src="assets/imgs/info.svg" />
                </ion-icon>
              </div>
            </div>
          </div>

          <!-- </div> -->
          <!-- Team mean tooltip -->

          <div class="arrowicon-container" (click)="openReviewersTeamList(teamMean.key,teamMean,reviewerItem?.employeeId)">
            <ion-icon name="ios-arrow-forward" class="team-iconSize"></ion-icon>
          </div>
        </div>
      </div>

    </div>

  </div>
</ion-content>

<ion-footer *ngIf="statusModel=='moderation'||selectedItem =='Reviewer'" class="submitfooter" >
  <div class="btnsubmit-footer">
    <button class="nextBtn" *ngIf="teamListResData?.isShowSubmitAll && (moderationList?.length > 0 || reviewersList?.length > 0) && !teamListResData?.isExpired"
      (click)="submitAllKra()" ion-button round >Submit All</button>
    <button class="nextBtn" disabled="true" *ngIf="!teamListResData?.isShowSubmitAll && !teamListResData?.isExpired" (click)="submitAllKra()"
      ion-button round>Submitted</button>

  </div>
</ion-footer>