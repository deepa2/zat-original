{"version":3,"sources":["../../src/container/search/search.module.ts","../../src/container/search/search.ts"],"names":[],"mappings":"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","file":"83.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ComponentsModule } from '../../components/components.module';\nimport { SearchPage } from './search';\n\n@NgModule({\n  declarations: [\n    SearchPage,\n  ],\n  imports: [\n    ComponentsModule,\n    IonicPageModule.forChild(SearchPage),\n  ],\n})\nexport class SearchPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/container/search/search.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { FormControl } from '@angular/forms';\nimport { Observable } from \"rxjs\";\nimport { Store } from \"@ngrx/store\";\nimport * as fromStore from '../../store';\nimport 'rxjs/add/operator/debounceTime';\nimport { Validators } from '@angular/forms';\nimport { Subscription } from 'rxjs/Subscription';\nimport { searchService } from '../../providers/services/searchService/searchService';\n\n@IonicPage()\n@Component({\n  selector: 'page-search',\n  templateUrl: 'search.html',\n})\nexport class SearchPage {\n  items$: any;\n  loading$: Observable<any>;\n  startList: number = 0;\n  endList: number = 15;\n  searchTerm: string = '';\n  searchType: any;\n  searchControl: FormControl;\n  searching: any = false;\n  infiniteScroll: any;\n  pageName: string = 'search';\n  recentSearchItems: Array<any> = [];\n  role: string;\n  totalResultCount: number;\n  showOptions: boolean = true;\n  itemsLength: number;\n  @ViewChild('inputToFocus') inputToFocus;\n\n  private _searchListener: Subscription = new Subscription();\n  private _searchTextUpdateListener: Subscription = new Subscription();\n  private _loaderListener: Subscription = new Subscription();\n  private _roleListener: Subscription = new Subscription();\n\n  constructor(private navCtrl: NavController, private navParams: NavParams,\n    private store: Store<fromStore.AppState>, private searchService: searchService) {\n    this.searchControl = new FormControl('', Validators.required);\n\n  }\n\n  ionViewDidEnter() {\n    setTimeout(() => {\n      this.inputToFocus.setFocus();\n    });\n  }\n\n  ionViewDidLoad() {\n\n    this.searchType = this.navParams.get('searchType');\n\n    this.loading$ = this.store.select<any>(fromStore.getSearchLoading);\n\n    this._searchTextUpdateListener = this.store.select<any>(fromStore.getSearchText).subscribe(values => {\n      this.recentSearchItems = values;\n    }, err => {\n    });\n\n    this.searchControl.valueChanges.debounceTime(1000).subscribe(search => {\n      if (!this.searchControl.hasError('required')) {\n        this.setFilteredItems('get');\n      } else if (this.searchControl.hasError('required')) {\n        this.setFilteredItems('reset');\n      }\n    });\n  }\n\n  ionViewWillEnter() {\n\n    this._roleListener = this.store.select<any>(fromStore.getRole).subscribe((res) => {\n\n      this.role = res;\n\n      if (this.role == 'admin' || this.role == 'hr') {\n        this.showOptions = true;\n      } else {\n        this.showOptions = false;\n      }\n\n    });\n\n  }\n\n  setFilteredItems(type: string) {\n\n    let url, params;\n\n    if (this.searchType == \"query\") {\n\n      params = {\n        \"start\": this.startList,\n        \"end\": this.endList,\n        \"role\": this.role,\n        \"searchText\": this.searchTerm,\n        \"status\": \"All\"\n      }\n      url = \"getQuestionList\";\n\n    }\n    else {\n\n      params = {\n        \"start\": this.startList,\n        \"end\": this.endList,\n        \"searchText\": this.searchTerm,\n      }\n      url = \"getAllAnnouncements\";\n\n    }\n\n\n    if (type == 'update') {\n      this.store.dispatch(new fromStore.UpdateSearchAction(url, params, this.searchType));\n    }\n    else if (type == \"get\") {\n      this.store.dispatch(new fromStore.OverallSearchAction(url, params, this.searchType));\n    }\n    else if (type == 'reset') {\n      this.store.dispatch(new fromStore.ResetSearchAction());\n    }\n\n    return new Promise(resolve => {\n      this._searchListener = this.store.select<any>(fromStore.getSearchState).subscribe(response => {\n\n        if (response.pending == false && response.loadMore == false && response.pullToRefresh == false) {\n          if (response.data) {\n            this.items$ = response.data;\n            this.totalResultCount = this.items$.length;\n          }\n          resolve();\n        }\n\n        // if (response) {\n        //   this.items$ = response;\n        //   this.itemsLength = response.length;\n        //   resolve();\n        // }\n\n      }, err => {\n      });\n    });\n  }\n\n  onSearchInput(ev) {\n    if (ev._value) {\n      this.searching = true;\n    } else {\n      this.searching = false;\n    }\n  }\n\n  doInfinite(infiniteScroll) {\n    this.infiniteScroll = infiniteScroll;\n\n    if (this.totalResultCount) {\n      this.startList = this.endList;\n      this.endList = this.startList + 15;\n      this.setFilteredItems('update').then(() => {\n        infiniteScroll.complete();\n      });\n    } else {\n      infiniteScroll.complete();\n    }\n\n  }\n\n  ionViewWillLeave() {\n    this._searchListener.unsubscribe();\n    this._searchTextUpdateListener.unsubscribe();\n    this._loaderListener.unsubscribe();\n    this._roleListener.unsubscribe();\n  }\n\n  clearRecentSearch() {\n    this.store.dispatch(new fromStore.OverallSearchClear());\n  }\n\n  searchRecent(value) {\n    this.searchTerm = value;\n  }\n\n  gotToListDetail(item) {\n\n    if (this.searchType == \"query\") {\n      this.navCtrl.push('DetailPage', {\n        'id': item.questionId\n      });\n    }\n\n  }\n\n  \n\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/container/search/search.ts"],"sourceRoot":""}