{"version":3,"sources":["../../src/container/announcement-ratings/announcement-ratings.module.ts","../../src/container/announcement-ratings/announcement-ratings.ts"],"names":[],"mappings":"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","file":"117.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AnnouncementRatingsPage } from './announcement-ratings';\nimport { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  declarations: [\n    AnnouncementRatingsPage,\n  ],\n  imports: [\n    ComponentsModule, \n    IonicPageModule.forChild(AnnouncementRatingsPage),\n  ],\n})\nexport class AnnouncementRatingsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/container/announcement-ratings/announcement-ratings.module.ts","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Store } from \"@ngrx/store\";\nimport * as fromStore from '../../store';\nimport { Observable } from \"rxjs\";\nimport { Subscription } from 'rxjs/Subscription';\n\n@IonicPage()\n@Component({\n  selector: 'announcement-ratings',\n  templateUrl: 'announcement-ratings.html',\n})\n\n\nexport class AnnouncementRatingsPage implements OnInit, OnDestroy {\n  url: string = 'getRatings';\n  ratingUrl: string = 'addRating';\n  comments$: Observable<any>;\n  loading$: Observable<any>;\n  itemsLength: number;\n  formData: FormData;\n  start: number = 0;\n  end: number = 10;\n  infiniteScroll: any = '';\n  refresher: any = '';\n  announcementId: any;\n  comment: any = '';\n  mode: any;\n  brag: boolean = false;\n  payload: any = {\n    \"announcementId\": this.announcementId,\n    \"start\": this.start,\n    \"end\": this.end,\n    \"mode\": this.mode\n  }\n\n  private _listListener: Subscription = new Subscription();\n  private _ratingListener: Subscription = new Subscription();\n\n  constructor(private navCtrl: NavController, private navParams: NavParams, private store: Store<fromStore.AppState>) {\n  }\n\n  ngOnInit() {\n    this.announcementId = this.navParams.get('announcementId');\n    this.mode = this.navParams.get('mode');\n\n    this.payload = {\n      \"announcementId\": this.announcementId,\n      \"start\": this.start,\n      \"end\": this.end,\n      \"mode\": this.mode\n    }\n\n    this.loading$ = this.store.select<any>(fromStore.getCommentsLoading);\n    this.store.dispatch(new fromStore.GetCommentsReset());\n    this.store.dispatch(new fromStore.GetComments(this.url, this.payload));\n    this.getComments();\n    this.getRatingState();\n  }\n\n  getComments() {\n\n    this._listListener = this.store.select<any>(fromStore.getCommentsState).subscribe((res) => {\n\n      if (res.data) {\n        this.comments$ = res.data;\n        this.itemsLength = res.data.length;\n      }\n\n      if (!res.pending && this.infiniteScroll) {\n        this.infiniteScroll.complete();\n      }\n\n      if (!res.pending && this.refresher) {\n        this.refresher.complete();\n      }\n    })\n  }\n\n  getRatingState() {\n\n    this._ratingListener = this.store.select<any>(fromStore.getAccouncementState).subscribe((res) => {\n      if (res) {\n\n        if (res.ratingData && !res.pending) {\n\n          //rating added\n\n          this.comment = '';\n\n          this.start = 0;\n          this.end = 10;\n\n          this.payload = {\n            \"announcementId\": this.announcementId,\n            \"start\": this.start,\n            \"end\": this.end,\n            \"mode\": this.mode\n          }\n\n          this.store.dispatch(new fromStore.GetCommentsReset());\n\n          this.store.dispatch(new fromStore.GetComments(this.url, this.payload));\n        }\n      }\n\n    })\n  }\n\n  formatDate(obj) {\n    return obj.toString().replace(/\\s/g, \"T\");\n  }\n\n  doInfinite(infiniteScroll) {\n\n    this.infiniteScroll = infiniteScroll;\n\n    this.start = this.end;\n    this.end = this.start + 10;\n\n    this.payload = {\n      \"announcementId\": this.announcementId,\n      \"start\": this.start,\n      \"end\": this.end,\n      \"mode\": this.mode\n    }\n\n    this.store.dispatch(new fromStore.GetComments(this.url, this.payload));\n\n  }\n\n  doRefresh(refresher) {\n\n    this.refresher = refresher;\n\n    this.start = 0;\n    this.end = 10;\n\n    this.payload = {\n      \"announcementId\": this.announcementId,\n      \"start\": this.start,\n      \"end\": this.end,\n      \"mode\": this.mode\n    }\n\n    this.store.dispatch(new fromStore.GetCommentsReset());\n\n    this.store.dispatch(new fromStore.GetComments(this.url, this.payload));\n\n  }\n  postComment() {\n    if (this.comment != \"\") {\n      let type = 'comment';\n      this.formData = new FormData();\n      this.formData.append('mode', type);\n      this.formData.append('commentText', this.comment);\n      this.formData.append('announcementId', this.announcementId);\n\n      this.store.dispatch(new fromStore.AddAnnouncementRating(this.ratingUrl, this.formData, type));\n    }\n\n\n  }\n\n  ngOnDestroy() {\n    this._listListener.unsubscribe();\n    this._ratingListener.unsubscribe();\n  }\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/container/announcement-ratings/announcement-ratings.ts"],"sourceRoot":""}